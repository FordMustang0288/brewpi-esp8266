

set(COPY_CMD "cp")
set(RM_CMD "rm")


add_custom_target(
    PLATFORMIO_COPY_BUILT_FIRMWARE

# TODO - Figure out how to ignore the return value if there aren't files already present with these filenames
#    COMMAND ${RM_CMD} "${CMAKE_CURRENT_SOURCE_DIR}/bin/esp8266_wifi.bin"
#    COMMAND ${RM_CMD} "${CMAKE_CURRENT_SOURCE_DIR}/bin/esp8266_serial.bin"
#    COMMAND ${RM_CMD} "${CMAKE_CURRENT_SOURCE_DIR}/bin/esp32_wifi_tft.bin"

    COMMAND ${COPY_CMD} "${CMAKE_CURRENT_SOURCE_DIR}/.pio/build/esp8266_wifi/firmware.bin" "${CMAKE_CURRENT_SOURCE_DIR}/bin/esp8266_wifi.bin"
    COMMAND ${COPY_CMD} "${CMAKE_CURRENT_SOURCE_DIR}/.pio/build/esp8266_serial/firmware.bin" "${CMAKE_CURRENT_SOURCE_DIR}/bin/esp8266_serial.bin"
    COMMAND ${COPY_CMD} "${CMAKE_CURRENT_SOURCE_DIR}/.pio/build/esp32_wifi_tft/firmware.bin" "${CMAKE_CURRENT_SOURCE_DIR}/bin/esp32_wifi_tft.bin"
    WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}
)